#  =========================================================================
#  Makefile for fgldoc navigator compilation and instalation
#
#  Build by Sergio Ferreira from Moredata, Lisbon, Portugal
#
#  $Id: Makefile.in,v 1.3 2003-01-12 09:22:45 afalout Exp $
#  =========================================================================

include ../FgldocDefs.mk

# =========================================================================
#                              Settings
# =========================================================================

#DocumentAudit.class Login.class
CLASS_FILES	= FunctionDescription.class FunctionParameter.class \
			FunctionReturn.class MainPanel.class ModuleDocument.class \
			ModuleDocumentOptions.class GenJsTree.class

#JSP_FILES	= function_error.jsp function_list.jsp index.jsp login.jsp \
#			module.jsp module_list.jsp process_list.jsp
JSP_FILES	=function_error.jsp module.jsp function_list.jsp module_list.jsp \
			index.jsp process_list.jsp login.jsp


OTHER_FILES	=build.xml stylesheet.css

#IMG_FILES	=ftv2blank.gif ftv2doc.gif ftv2folderclosed.gif ftv2folderopen.gif \
#			ftv2lastnode.gif ftv2link.gif ftv2mlastnode.gif ftv2mnode.gif  \
#			ftv2plastnode.gif ftv2pnode.gif ftv2vertline.gif ftv2node.gif

IMG_FILES	=ftv2link.gif ftv2mlastnode.gif ftv2blank.gif ftv2mnode.gif \
			ftv2doc.gif ftv2node.gif ftv2folderclosed.gif  ftv2plastnode.gif \
			ftv2folderopen.gif ftv2pnode.gif ftv2lastnode.gif ftv2vertline.gif

JS_FILES	= treeview.js

.PHONY : all install clean deinstall

# =========================================================================
#                        	   Targets
# =========================================================================

#all: $(CLASS_FILES)
all: ant



ant: /usr/share/java/catalina-ant.jar
ifneq "${ANT}" "no"
ifneq "${JAVAC}" "no"
#directory missing on some Tomcar installations, but needed by build.xml:
	mkdir -p ${TOMCAT_DIR}/shared/lib
	export CLASSPATH=$CLASSPATH:$^; ${ANT}
else
	@echo "Java compiler not found - cannot compile"
endif
else
	@echo "Ant tool not found - cannot compile"
endif

/usr/share/java/catalina-ant.jar:
#Tomcat specifc targets for Ant:
	cp /var/tomcat4/server/lib/catalina-ant.jar /usr/share/java/

$(CLASS_FILES): all

# =========================================================================
#                              Rules
# =========================================================================

#we use ant now:
#%.class : %.java
#	@JAVAC@ $?

# =========================================================================
#                              Install
# =========================================================================

install: $(CLASS_FILES)
ifneq "${TOMCAT_DIR}" "no"
	mkdir -p ${NAV_DIR}
	mkdir -p ${CLASS_DIR}
	$(INSTALL) $(CLASS_FILES) $(CLASS_DIR)
	$(INSTALL) $(JSP_FILES) $(NAV_DIR)
	$(INSTALL) $(IMG_FILES) $(NAV_DIR)
	$(INSTALL) $(JS_FILES) $(NAV_DIR)
#and ccs?
else
	@echo "Tomcat directory unknown. Cannot install"
endif

# =========================================================================
#                              Deinstall
# =========================================================================

deinstall:
ifneq "${TOMCAT_DIR}" "no"
	(cd $(CLASS_DIR); ${RM} -f $(CLASS_FILES))
	(cd $(NAV_DIR); ${RM} -f $(JSP_FILES))
	(cd $(NAV_DIR); ${RM} -f $(IMG_FILES))
	(cd $(NAV_DIR); ${RM} -f $(JS_FILES))
else
	@echo "Tomcat directory unknown. Cannot deinstall"
endif
# =========================================================================
#                              Clean
# =========================================================================

clean:
	$(RM) -f *.class *.jar *.bak
	rm -rf classes
	rm -rf build

# =================================== EOF =================================
