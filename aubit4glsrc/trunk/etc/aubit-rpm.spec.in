###########################################################################
#			RPM Package manager config file for Aubit 4gl
#
# Initial spec file created by autospec ver. 0.6 with rpm 2.5 compatibility
# for Aubit 4gl version 0.20
###########################################################################

#
# $Id: aubit-rpm.spec.in,v 1.15 2003-07-21 09:22:08 afalout Exp $
#

#There may be times when RPM's automatic dependency processing is not
#desired. In these cases, the autoreqprov tag may be used to disable it.
#This tag takes a yes/no or 0/1 value. For example, to disable automatic
#dependency processing, the following line may be used:
#This is needed in case of Aubit, because otherwise all dependencies for
#all modules like GTK+ unixODBC, iODBC, ESQL/C, PDFlib, wtc, will be defined
#as prerequisites for installing Aubit, which is not true, since Aubit can
#be configured to use this extensions only if they are installed on target 
#system
AutoReqProv: no


##############
#Description
##############
Summary: @FULLNAME@
Name: @SHORTNAME@
Version: @AUBIT_VERSION@.@AUBIT_BUILD@
Release: 1
Copyright: GNU GPL/LGPL
Vendor: Aubit development team
Packager: Andrej Falout <afalout@ihug.co.nz>
Group: Development/Languages
URL: http://aubit4gl.sourceforge.net
Distribution: Red Hat Contrib-Net
BuildArchitectures: @target_cpu@

#Provides is supposed to specify a capability needed by other packages,
#that can be provided by more then one package. For instance, both 4Js BDL,
#Querix Hydra, and Informix RDS provide Informix-4gl compatible compiler.
Provides: x4gl_compiler

#Finding  Requires: (using /usr/lib/rpm/find-requires)...
Requires: glibc >= 2.2, glibc-devel >= 2.2, /bin/bash, /bin/sh, make

#Obsoletes:
#BuildRoot: /tmp/aubit4glsrc-%{version}-root
Prefix: /opt

#WARNNING: file name used here will need to be present on local system
#at time of building RPM:
Source: http://aubit4gl.sourceforge.net/files/%{name}src-@AUBIT_VERSION@-@AUBIT_BUILD@.@ARCHEXT@

#Patch: aubit4glsrc-%{version}.patch

##############
%description
##############
Aubit 4gl (Fourth Generation programing Language) compiler compiles source
files to several low-level programming languages (C, Perl, Java...). It has
ODBC and native database conectivity, GUI interface and many features.

Install Aubit compiler if you want to write business related database
oriented (BRDO) applications.

##############
%prep
##############
%setup -c aubit4glsrc
#%setup -n /usr/aubit/aubit4glsrc

#%patch
#%patch -p1
#%patch1 -p1

##############
%build
##############
#cd %{name}src-%{version}
cd %{name}src-@AUBIT_VERSION@-@AUBIT_BUILD@
./configure
make RPM_OPT_FLAGS="$RPM_OPT_FLAGS"
#CFLAGS="$RPM_OPT_FLAGS" ./configure --prefix=/usr

##############
%install
##############
#install -s -m 755 -o 0 -g 0 loadmap /usr/bin/loadmap
#install -m 644 -o 0 -g 0 eject.1 /usr/man/man1
#cd %{name}src-%{version}
cd %{name}src-@AUBIT_VERSION@-@AUBIT_BUILD@
make install


##############
#%clean
##############
#[ "$RPM_BUILD_ROOT" != "/" ] && rm -rf "$RPM_BUILD_ROOT"

##############
%files
##############
%defattr(-,root,root)

#Directories to be created:
%dir /opt/aubit4gl/bin
%dir /opt/aubit4gl/lib
%dir /opt/aubit4gl/etc
%dir /opt/aubit4gl/etc/config
%dir /opt/aubit4gl/incl
%dir /opt/aubit4gl/tools/test/gui
%dir /opt/aubit4gl/tools/test
%dir /opt/aubit4gl/tools
%dir /opt/aubit4gl/docs

#Files that will be created depending on system confuguration, defined
#from configure:
@RPMFILE_1@
@RPMFILE_2@
@RPMFILE_3@
@RPMFILE_4@
@RPMFILE_5@
@RPMFILE_6@
@RPMFILE_7@
@RPMFILE_8@
@RPMFILE_9@
@RPMFILE_10@
@RPMFILE_11@
@RPMFILE_12@
@RPMFILE_13@
@RPMFILE_14@
@RPMFILE_15@
@RPMFILE_16@
@RPMFILE_17@
@RPMFILE_18@
@RPMFILE_19@
@RPMFILE_20@
@RPMFILE_21@
@RPMFILE_22@
@RPMFILE_23@
@RPMFILE_24@
@RPMFILE_25@
@RPMFILE_26@
@RPMFILE_27@
@RPMFILE_28@
@RPMFILE_29@
@RPMFILE_30@


#Below are only files that should be created by make in any case:

## ==================================================================
##               Files that are allways created
## ==================================================================

#Shared libraries:
@LIBFILE_1@
@LIBFILE_2@
@LIBFILE_3@
@LIBFILE_4@
@LIBFILE_5@
@LIBFILE_6@
@LIBFILE_7@
@LIBFILE_8@
@LIBFILE_9@
@LIBFILE_10@
@LIBFILE_11@
@LIBFILE_12@
@LIBFILE_13@
@LIBFILE_14@
@LIBFILE_15@
@LIBFILE_16@
@LIBFILE_17@
@LIBFILE_18@
@LIBFILE_19@
@LIBFILE_20@
@LIBFILE_21@
@LIBFILE_22@
@LIBFILE_23@
@LIBFILE_24@
@LIBFILE_25@
@LIBFILE_26@
@LIBFILE_27@
@LIBFILE_28@
@LIBFILE_29@
@LIBFILE_30@

#Executables:
/opt/aubit4gl/bin/4glc
/opt/aubit4gl/bin/fcompile
/opt/aubit4gl/bin/fdecompile
/opt/aubit4gl/bin/mcompile
/opt/aubit4gl/bin/mdecompile
#/opt/aubit4gl/bin/mkmess
/opt/aubit4gl/bin/amkmessage
/opt/aubit4gl/bin/unmkmessage

/opt/aubit4gl/bin/loadmap
/opt/aubit4gl/bin/fshow
/opt/aubit4gl/bin/aubit-config
/opt/aubit4gl/bin/xgen
/opt/aubit4gl/bin/aace
/opt/aubit4gl/bin/adecompile

#FIXME:
#error: File not found: /opt/aubit4gl/bin/convertsql
#error: File not found: /opt/aubit4gl/bin/aace_4gl
#error: File not found: /opt/aubit4gl/bin/aace_perl
#error: File not found: /opt/aubit4gl/bin/ecpg_wrap

#Shell scripts:
/opt/aubit4gl/bin/4glpc
/opt/aubit4gl/bin/amake
/opt/aubit4gl/bin/amakeallo
/opt/aubit4gl/bin/amakeallf
/opt/aubit4gl/bin/aubit
/opt/aubit4gl/bin/genmake
/opt/aubit4gl/bin/prepmake


#Include files:
/opt/aubit4gl/incl/a4gl_incl_4glhdr.h
/opt/aubit4gl/incl/a4gl_incl_4gldef.h

/opt/aubit4gl/incl/header.mki
#/opt/aubit4gl/incl/maximise.mki
#/opt/aubit4gl/incl/a4gl-rules.mki
/opt/aubit4gl/incl/footer-c.mki
/opt/aubit4gl/incl/footer.mki

/opt/aubit4gl/incl/a4gl.mk
/opt/aubit4gl/incl/i4gl.mk
/opt/aubit4gl/incl/q4gl.mk
/opt/aubit4gl/incl/d4gl.mk

#Examples:
"/opt/aubit4gl/tools/test/*.4gl"
"/opt/aubit4gl/tools/test/*.per"
"/opt/aubit4gl/tools/test/*.msg"
"/opt/aubit4gl/tools/test/gui/*.4gl"
"/opt/aubit4gl/tools/test/gui/*.per"

#Makefiles:
/opt/aubit4gl/incl/Makefile-common
/opt/aubit4gl/tools/test/Makefile
/opt/aubit4gl/tools/test/gui/Makefile
/opt/aubit4gl/Makefile
/opt/aubit4gl/incl/Makefile-install.mki

#Documentation files:
%doc /opt/aubit4gl/README.txt
%doc /opt/aubit4gl/docs/changelog.txt
%doc /opt/aubit4gl/docs/COPYING
%doc /opt/aubit4gl/docs/CREDITS
%doc /opt/aubit4gl/docs/LICENSE

#Configuration files:
%config /opt/aubit4gl/etc/odbc.ini.example
%config /opt/aubit4gl/etc/aubitrc-bin.in
/opt/aubit4gl/configure
/opt/aubit4gl/install.sh
/opt/aubit4gl/etc/config/config.guess
/opt/aubit4gl/etc/config/config.sub
/opt/aubit4gl/etc/config/install-sh
/opt/aubit4gl/etc/config/missing
/opt/aubit4gl/etc/config/mkinstalldirs


##############
%changelog
##############
* Sun Aug 25 2002 root <root@aptiva.falout.com>
- Synchronised files between tarball and RPM
* Thu Dec 06 2001 root <root@aptiva.falout.com>
- Manually modified autospec version
* Thu Dec 06 2001 root <root@aptiva.falout.com>
- Initial spec file created by autospec ver. 0.6 with rpm 2.5 compatibility


##############
#%pre
#is the macro to do pre-install scripts.
##############

##############
%post
#is the macro to do post-install scripts.
##############

#[ ! -d $RPM_INSTALL_PREFIX/bin ] && mkdir $RPM_INSTALL_PREFIX/bin > /dev/null 2>&1
#ln -fs $RPM_INSTALL_PREFIX/aubit4gl/bin/4glpc $RPM_INSTALL_PREFIX/bin/4glpc
#
#[ ! -d /etc/opt/aubit4gl ] && mkdir /etc/opt/aubit4gl > /dev/null 2>&1
#[ ! -f /etc/opt/aubit4gl/aubitenv	 ] && cp $RPM_INSTALL_PREFIX/aubit4gl/bin/aubitenv.example /etc/opt/aubit4gl/aubitenv

cd /opt/aubit4gl
#run 'configure', create and install /etc/opt/aubit4gl/aubitrc, install 
#links to /usr/bin and /usr/lib, run test_build:
make

##############
%preun
# is the macro to do pre-uninstall scripts.
##############
cd /opt/aubit4gl
#remove links created by 'make', and debris in tools/test
make deinstall

##############
#%postun
# is the macro to do post-uninstall scripts.
##############



#-------------------------------- EOF ----------------------------------

