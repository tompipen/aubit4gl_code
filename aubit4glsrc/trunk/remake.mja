A4GL_LEXTYPE=C
export A4GL_LEXTYPE
unset A4GL_LEXDIALECT

unset DEBUG

if [ "$1" != "" ] 
then
	cvs update -d 
	make cleanall
	./configure  --with-pgsql=/usr/local/pgsql --with-ecpg=/usr/local/pgsql --without-sapdb  --prefix=/home/aubit4gl/aubit4gl
fi



cd /home/aubit4gl/sourceforge/aubit4glsrc
make -k log

if [ $? != 0 ]
then
	echo "Make failed..."
	tail -10 make.log
	exit
fi
cd /home/aubit4gl/sourceforge/aubit4glsrc
cd lib/libui/ui_curses
sh make_static

cd /home/aubit4gl/sourceforge/aubit4glsrc
cd lib/libsql/esqlc
sh make_static
sh make_simple


cd /home/aubit4gl/sourceforge/aubit4glsrc/lib/libesql
sh make_static
sh make_simple


cd /home/aubit4gl/sourceforge/aubit4glsrc
cp lib/*.so /home/aubit4gl/aubit4gl/lib
cp incl/*.h /home/aubit4gl/aubit4gl/incl

cd /home/aubit4gl/sourceforge/aubit4glsrc/tools/afinderr

cp /home/aubit4gl/sourceforge/aubit4glsrc/tools/afinderr/afinderr /home/aubit4gl/aubit4gl/bin
cp /home/aubit4gl/sourceforge/aubit4glsrc/help/* /home/aubit4gl/aubit4gl/help

cd /home/aubit4gl/sourceforge/aubit4glsrc/tools/test/build_tests
find /home/aubit4gl/sourceforge/aubit4glsrc/tools/test/build_tests -name "*.4ae" -exec rm {} \;
find /home/aubit4gl/sourceforge/aubit4glsrc/tools/test/build_tests -name "*.afr*" -exec rm {} \;
sh run_tests
if grep -y "Fail" build.log 
then
	banner "Test Failed"
fi
